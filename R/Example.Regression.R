setwd("~/GitHub/stat440/R")
source("MultivariableRegression.R")

require(MASS)
D <- Boston
Y <- D[c("crim", "zn", "indus", "tax", "black", "lstat")]
X <- D[c("chas", "nox", "rm", "age", "dis", "rad", "ptratio", "medv")]

Result <- lm.multivariable(100000,as.matrix(X),as.matrix(Y))

# Now that we have that, we can generate 95% credibility interval
#by generating lower and upper quantiles

apply(Res$B, c(1,2), quantile, probs = 0.025)

#        [,1]       [,2]        [,3]        [,4]       [,5]        [,6]
#[1,] -2.4726166 -5.8679744  0.09608906 -32.9824267 -11.281075 -1.55826198
#[2,] -6.9573162 -0.8674746 20.12296722 256.4240012  71.771290 12.86687197
#[3,]  0.6781378  1.6702512 -1.27047227  -2.1000956 -14.681060 -1.33368492
#[4,] -0.1553847 -0.4728362 -0.09345642  -1.6003269  -1.790386 -0.08581789
#[5,] -0.5264732  6.4092475 -0.97953076   0.1691556   8.454171  0.20377180
#[6,]  0.4767344  0.2930137  0.04739809  13.7503723  -5.358764 -0.03775675
#[7,] -0.1783143 -2.4605295  0.36683531   4.8444292  11.568813  0.34594612
#[8,] -0.2359186  0.1865307 -0.06683020  -1.3784741   3.828851 -0.31275303

apply(Res$B, c(1,2), quantile, probs = 0.975)
#          [,1]       [,2]        [,3]       [,4]       [,5]       [,6]
#[1,]  1.23005537  3.0281855  2.38564313   4.015556  35.343992  2.2987712
#[2,]  4.38696504 26.3870831 27.15237654 370.716817 213.885742 24.6638782
#[3,]  2.15970956  5.2094969 -0.35461696  12.693659   3.842477  0.1986968
#[4,]  0.25299883  0.5131117  0.16027636   2.474993   3.370447  0.3374899
#[5,] -0.04380559  7.5768624 -0.67862663   5.027720  14.598202  0.7109332
#[6,]  0.63084308  0.6644552  0.14276972  15.299609  -3.412688  0.1239872
#[7,] -0.04911195 -2.1502284  0.44578529   6.134446  13.188602  0.4797648
#[8,] -0.19998163  0.2726097 -0.04467733  -1.018740   4.279617 -0.2754563

# Likewise we can generate the intervals for V

apply(Res$V, c(1,2), quantile, probs = 0.025)
#        [,1]        [,2]        [,3]       [,4]       [,5]        [,6]
#[1,]  33.929213    3.572982  -2.8734031  -35.94742  -71.79034   1.3119148
#[2,]   3.572982  201.484879  -4.6415480  119.76413 -114.39604   2.4386847
#[3,]  -2.873403   -4.641548  11.6966058   73.61370  -32.95110  -0.5026867
#[4,] -35.947422  119.764128  73.6137027 3254.96522 -337.01431 -13.0942620
#[5,] -71.790337 -114.396039 -32.9510957 -337.01431 5127.69941 -24.1551878
#[6,]   1.311915    2.438685  -0.5026867  -13.09426  -24.15519  13.8606121
apply(Res$V, c(1,2), quantile, probs = 0.975)
#[,1]       [,2]        [,3]       [,4]        [,5]      [,6]
#[1,] 42.8448517  19.031231   0.8469221   26.32315    6.156278  5.394610
#[2,] 19.0312313 254.479476   4.3884423  273.79120   74.709301 12.389779
#[3,]  0.8469221   4.388442  14.7900251  112.99105   12.895214  1.861531
#[4,] 26.3231463 273.791203 112.9910503 4111.03012  424.611619 26.220897
#[5,]  6.1562782  74.709301  12.8952138  424.61162 6468.929288 25.610153
#[6,]  5.3946102  12.389779   1.8615311   26.22090   25.610153 17.513825